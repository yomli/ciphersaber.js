var CipherSaber=new function(){this.message="Hello World!",this.password="password",this.cycles=20,this.seed=[],this.ruby=[],this.light=[],this.output=[],this.button=[],this.refractor=function(){var t=0,i=0;for(n=0;n<this.message.length;n++){t=parseInt(t+1)%256,i=parseInt(i+this.light[t])%256;var s=this.light[t];this.light[t]=this.light[i],this.light[i]=s;var h=parseInt(this.light[t]+this.light[i])%256;this.output[n]=this.light[h]^this.message[n]}},this.emission=function(){var t=0;for(i=0;i<256;i++)this.light[i]=i;for(n=1;n<=this.cycles;n++)for(i=0;i<256;i++){t=parseInt(t+this.light[i]+this.ruby[i])%256;var s=this.light[i];this.light[i]=this.light[t],this.light[t]=s}},this.pushButton=function(){var t=this.password.concat(this.seed);for(i=0;i<256;i++){var s=t.shift();this.ruby[i]=s,t.push(s)}},this.encrypt=function(t,s,h){for(this.message=this.toByte(t),this.password=this.toByte(s),this.cycles=h,i=0;i<10;i++)this.seed[i]=Math.round(256*Math.random());this.pushButton(),this.emission(),this.refractor();var e="";for(i=0;i<this.seed.length;i++)e+=this.toHex(this.seed[i])+" ";for(i=0;i<this.output.length;i++)e+=this.toHex(this.output[i])+" ";return e},this.decrypt=function(t,s){for(this.password=this.toByte(s),this.message=t.split(" "),i=0;i<this.message.length;i++)this.message[i]=parseInt(this.message[i],16),isNaN(this.message[i])&&this.message.splice(i,1);this.seed=this.message.splice(0,10),this.pushButton(),this.emission(),this.refractor();var h="";for(i=0;i<this.output.length;i++)h+=String.fromCharCode(this.output[i]);return h},this.toByte=function(t){var s=[];for(i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s},this.toHex=function(t){for(var i=Number(t).toString(16);i.length<2;)i="0"+i;return i}};